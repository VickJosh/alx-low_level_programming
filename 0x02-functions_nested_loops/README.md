here we go with functions and nested loops
